# ==============================================================
# ProtHint: Pipeline for generating genome wide footprints of homologous proteins
#
# Georgia Institute of Technology
# Last modified: October, 2018
#
# Dr. Mark Borodovsky
# Bioinformatics Lab
#
# ==============================================================
# Copyright 2019, Georgia Institute of Technology, USA
# ==============================================================

This pipeline predicts intron, start and stop codons in the genome of interest by
mapping and aligning predicted genes to a database of reference protein sequences.

#------------------------------------
1. INPUT

Inputs:
	* Genomic sequence from the target species in multi-FASTA format
	* Reference protein sequences in multi-FASTA format

Algorithm is applicable to complete as well as draft genome assemblies.

Input sequence format is FASTA. We use the first word in the definition line of FASTA
format as ID for corresponding sequence. Each sequence should have unique identifier.

Examples of valid definition lines:
    >contig_10
    ID: contig10
    > seq3  genome Z
    ID: seq3
    >IV contig 25
    ID: IV

#------------------------------------
2. DATABASE PREPARATION

We recommend to use OrthoDB protein database as the source of reference protein sequences.

For example, if your genome of interest is an insect, download arthropoda proteins:

    wget https://v100.orthodb.org/download/odb10_arthropoda_fasta.tar.gz
    tar xvf odb10_arthropoda_fasta.tar.gz

Concatenate proteins from all species into a single file:

    cat arthropoda/Rawdata/* > proteins.fasta

OrhoDB proteins sometimes end with a "." symbol. This format is not compatible with
DIAMOND, therefore the dot needs to be removed:

    sed -i "s/\.//" proteins.fasta

For other genomes of interest, choose a corresponding taxonomic root at https://www.orthodb.org/?page=filelist
and repeat the same procedure.

#------------------------------------
3. RUNNING THE PIPELINE

To run the pipeline use the following command:

    prothint.py genome.fasta proteins.fasta

See the example folder for a sample input and output.


To display a list of all available options, use:

    prothint.py --help

Frequently used options are:

    --workdir WORKDIR   Folder for results and temporary files. If not
                        specified, current directory is used

    --geneMarkGtf GENEMARKGTF
                        File with GeneMark-ES predictions in gtf format. If
                        this file is provided, GeneMark-ES run is skipped.

    --diamondPairs DIAMONDPAIRS
                        File with "seed gene-protein" hits generated by
                        DIAMOND. If this file is provided, DIAMOND search for
                        protein hits is skipped.

#------------------------------------
4. OUTPUT

ProtHint generates two main outputs:

    * prothint.gff:           Gff file with all mapped hints (introns, starts and stops)
    * evidence.gff:           High confidence subset of prothint.gff which is, for instance,
                              suitable for the GeneMark-EP Plus mode. This set is generated
                              using default thresholds in ProtHint/bin/print_high_confidence.py
                              script. If you wish to use different filtering criteria, re-run
                              print_high_confidence.py script with custom thresholds.

Corresponding Augustus-compatible files are also generated:

    * prothint_augustus.gff
    * evidence_augustus.gff

# ==============================================================
